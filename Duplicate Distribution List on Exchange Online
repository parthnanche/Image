# Variables
$SourceDistributionlist = "OldDL@yourdomain.com"
$NewDistributionlist = "NewDL@yourdomain.com"
$NewDistributionlistName = "New Distribution List"

# 1. Get members of the source DL
$Members = Get-DistributionGroupMember -Identity $SourceDistributionlist

# 2. Create a new Distributionlist
New-DistributionGroup -Name $NewDistributionlistName -PrimarySmtpAddress $NewDistributionlist -Type Distribution

# 3. Add members to the new Distributionlist
foreach ($member in $Members) {
    Add-DistributionGroupMember -Identity $NewDistributionlist -Member $member.PrimarySmtpAddress
}

Write-Host "Distribution list '$SourceDistributionlist' successfully duplicated to '$NewDistributionlist'."
